from Crypto.Util.number import long_to_bytes
import gmpy2
import math
from sympy import *
from decimal import *

#Solve simple RSA with known values
def decrypt(p, q, e, ct):
    n = p * q
    phi = (p - 1) * (q - 1)
    d = pow(e, -1, phi)
    if(n == 0):
        return
    pt = pow(ct, d, n)
    return long_to_bytes(pt).decode()

#Decrypt RSA where primes are equal
def decrypt2(n, e, ct):
    p = int( gmpy2.iroot(n,2)[0])
    phi = pow(p, 2) - p
    d = pow(e, -1, phi)
    pt = pow(ct, d, n)
    return long_to_bytes(pt).decode()

#Decrypting RSA with almost equal primes
def decrypt3(n, e, ct):
    base = int( gmpy2.iroot(n,2)[0])
    p = base
    q = base
    while True:
        p += 1
        if isprime(p):
            break
    while True:
        q -= 1
        if isprime(q):
            break
    print(decrypt(p, q, e, ct))

def decrypt4(n, e, ct):
    p = 1
    base = Decimal(n) / 2
    while p < base:
        p += 1
        if isprime(p) == false:
            continue
        q = Decimal(n) / Decimal(p)  
        print(p)
        result = decrypt(p, q, e, ct)
        print(result)

decrypt4(209239936016691180250674414150207311617438262291907559483508031897075226594354581241764661052495636746030881164018755996217592999341295309121117596460375096715646853214847258032450917163279882157744072472571089577725340013888023240416395621370904996675081937580519787276748117581935101804296590749237583706054721569976616627364203037887478158585394415933596776922486559358829776945147511354256588597019646799512782517886481147079103484484310899416963417463693015343124840763551800615994379637805462402956235814190656997326592359515447518588778216627520842282615371373283881012447523495633011144471508005597721,
65537,
191303376318440953575668896247477720114055191191887721297810745314032464168861573422778402409096715686656782117246687459999978766240199385622543568616854913109851304650650769512532902799707463278480646431152608285425215982053800816033667595886234260263227167461153539351929910624569332549724110678613542516554835000768028591093721430885427479598102917525038423649033383201931304311393580784461858528694453008929666385996900938694584030342252953111792591017556384304972205765167632598674670245440281245076472435245318568265290034876052095066074598441462483310889147214316204068511902624927860335172089043202250)